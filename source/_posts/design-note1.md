title: 组合与继承
date: 2016-01-05 10:57:11
categories: Design pattern
tags: [Design pattern]
---
继承是应对变化的环境以及上下文设计的有效方式，然而也会限制了它的灵活性，尤其是在类承担过多的责任的时候。下面我们一起学习下这个问题。给大家说下组合与继承一起使用的好处。
<!--more-->


我们处理大学课程收费的问题。大学里面的课程十分多所以我们可以先抽象出一个父类，让子类是继承父类实现对应的功能。
如图：
![](http://7xokym.com1.z0.glb.clouddn.com/design_note1_1.jpg)
利用这种继承模式我们可以在课程直接切换。而客户端只要知道它是在处理一个lesson对象，费用的细节就会变的相对透明。

但是当我们引入一组新的特性的时候，比如我们需要处理研讨会和演讲。因为这两种模式的特性必须要定义一个新的类。因此再设计上面会有两个分支。我们需要不同的计算价格的策略去区分这两种方式。
可能你会想到如下图的设计
![](http://7xokym.com1.z0.glb.clouddn.com/design_note1_2.jpg)
但是这样的方案有明显的缺陷。我们不得不大量的重复开发，否则无法使用继承的模式来实现。
或许你会想到我们可以把区分不同计算价格的东西给放到父类上面去。设计图如下:
![](http://7xokym.com1.z0.glb.clouddn.com/design_note1_3.jpg)
在父类里面我们可以通过条件分支的方式去做，但是这样的写法就会与用多态替换条件的重构思想冲突。
但是我们可以考虑用组合和继承结合的模式去实现这样的功能，如下图：
![](http://7xokym.com1.z0.glb.clouddn.com/design_note1_5.jpg)
我们可以看出组合使用对象比使用继承体系更灵活，其实这里面也用到了策略模式的思想。我们可以通过组合以多种方式动态的处理任务，不过可能会导致可读性性下降，但是它大大的减少了耦合性。