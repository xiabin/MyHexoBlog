title: Amdahl定律
date: 2016-12-03 17:02:18
categories: Java
tags: [Java]
mathjax: true
---

加速比定义：加速比=优化前系统耗时/优化后系统耗时

所谓加速比，就是优化前的耗时与优化后耗时的比值。加速比越高，表明优化效果越明显。

<!-- more-->

Amdahl定律给出了加速比与系统并行度和处理器数量的关系。设加速比为Speedup，系统内必须串行化的程序比重为F，CPU处理器数量为N，则有

$ Speedup <= 1/(F+(1-F)/N) $

根据这个公式，如果CPU处理器数量趋于无穷，那么加速比与系统的串行化率成反比，如果系统中必须有50%的代码串行执行，那么系统的最大加速比为2。

假设有一程序分为以下步骤执行，每个执行步骤花费100个时间单位。其中，只有步骤2和步骤5可以进行并行，步骤1、3、4必须串行，。在全串行的情况下，系统合计耗时500个时间单位。


若将步骤2和步骤5并行化，假设在双核处理上,步骤2和步骤5的耗时将为50个是单位.故系统整体耗时为400个时间单位。根据加速比的定义有：

加速比=优化前系统耗时/优化后系统耗时=500/400=1.25

或者前文中给出的加速比公式。由于5个步骤中，3个步骤必须串行，因此其串行化比重为3/5=0.6，即F=0.6，且双核处理器的处理器个数N为2。代入公式得：加速比=1/(0.6+(1-0.6)/2)=1.25

在极端情况下,步骤2和步骤5的处理时间趋于0。即使这样，系统整体耗时依然大于300个时间单位。即加速比的极限为500/300=1.67。

使用加速比计算公式，N趋于无穷大，有Speedup=1/F，且F=0.6，故有Speedup=1.67。

由此可见，为了提高系统的速度，仅增加CPU处理器的数量并不一定能起到有效的作用，需要从根本上修改程序的串行行为，提高系统内可并行化的模块比重，在此基础上，合理增加并行处理器数量，才能以最小的投入，得到最大的加速比。

注意：根据Amdahl定律，使用多核CPU对系统进行优化，优化的效果取决于CPU的数量以及系统中的串行化程序的比重。CPU数量越多，串行化比重越低，则优化效果越好。仅提高CPU数量而不降低程序的串行化比重，也无法提高系统性能。